<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: RuleAPI</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: RuleAPI</h1>

    




<section>

<header>
    
        <h2>RuleAPI</h2>
        
            <div class="class-description">This API class is used to describe the interface to rule operations. The methods indicate how the
data can be passed to and from the rule. Multiple input and output methods can return true. This allows the
application to select the best option for connecting two rules together.

Classes derived from this class must implement <a href="BaseRuleAPI.html#run">BaseRuleAPI.run()</a>. The implementation
should use the methods in this class to get the input data to the rule and set the output results using the
<code>as*()</code> methods. A rule may return a <code><a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>
</code> and if so must ensure that the <code>resolve()</code>
methods returns via one of the <code>as*()</code> methods.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="RuleAPI"><span class="type-signature"></span>new RuleAPI<span class="signature">(localConfig)</span><span class="type-signature"></span></h4>

    



<div class="description">
    The base constructor. This simply sets <code>this.config</code> to the passed in configuration object. This config object
will be the rule's individual configuration (if any) and additionally contain <code>RootDirectory</code> which defaults to
the application's root directory if not set, <code>TempDirectory</code> which defaults to the application's temporary
directory if not set, <code>OutputEncoding</code> which is set to the rule's Encoding if set or to the ruleset's Encoding
if set, and <code>utf8</code> if none are set, and <code>Encoding</code> which is set to the input file's encoding. (Note
the distinction between <code>Encoding</code> and <code>OutputEncoding</code>. <code>Encoding</code> is set to the source file's encoding and
<code>OutputEncoding</code> is set to the encoding of the file generated by the rule. In general these would be the same
but rule's may want to switch one uncommon encoding for another more common one.)
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>localConfig</code></td>
            

            <td class="type">
            
                
<span class="param-type">object</span>


            
            </td>

            

            

            <td class="description last">the rule's configuration as defined in the ruleset file or a standalone config file.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line90">line 90</a>
    </li></ul></dd>
    

    

    

    
</dl>
















    
    </div>

    

    

    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="inputFile"><span class="type-signature"></span>inputFile<span class="type-signature"></span></h4>




<div class="description">
    A <code>run()</code> implementation calls this when it wants to get the data from a file.
If the rule was initialized with a filename it is returned. If it was initialized with a data object
then that data is first saved to a file and the name of the file is returned. If however the rule was initialized with
a stream a little more work is required. In this case the stream must be written to a file and this is done asynchronously
so a Promise is returned. When the Promise is resolved the file will be available. Rules that require a
file should have a <code>run()</code> method that is something like this.
<pre><code>
run() {
	let input = this.inputFile;

	if (input instanceof Promise)
		return input.then((filename) => {
			return this._runImpl(filename);
		});
	else
		return this._runImpl(input);
}
	 </code></pre>
(where <code>this._runImpl(data)</code> is the actual implementation of the rule taking a filename as an argument.)<br/>
Rules may return Promises. However that promise must resolve() to an actual result. It cannot resolve to another
Promise.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line252">line 252</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="inputStream"><span class="type-signature"></span>inputStream<span class="type-signature"></span></h4>




<div class="description">
    A <code>run()</code> implementation calls this when it wants to get the data through a stream.
If the rule was initialized with a stream it is returned. If it was initialized with a data object
then that data is written into a stream which is returned. Finally, if the rule was initialized with
a file then a stream is opened up reading the file and that stream is returned. Unlike <a href="RuleAPI.html#object">object</a>
and <a href="RuleAPI.html#inputFile">inputFile</a> this property will never return a Promise it will only ever return a readable stream.<br/>
Rules may return Promises. However that promise must resolve() to an actual result. It cannot resolve to another
Promise.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line290">line 290</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="object"><span class="type-signature"></span>object<span class="type-signature"></span></h4>




<div class="description">
    A <code>run()</code> implementation calls this when it wants to get the data as an object (usually a String).
If the rule was initialized with a data object that object is returned. If it was initialized with a filename
then the file is first loaded and then the retrieved data is returned. If however the rule was initialized with
a stream a little more work is required. In this case the stream must be read and this is done asynchronously
so a Promise is returned. When the promise is resolved the data will be available. Rules that require an
object should have a <code>run()</code> method that is something like this.
<pre><code>
run() {
	let input = this.object;

	if (input instanceof Promise)
		return input.then((data) => {
			return this._runImpl(data);
		});
	else
		return this._runImpl(input);
}
	 </code></pre>
(where this._runImpl(data) is the actual implementation of the rule taking a data object as an argument.)<br/>
Rules may return Promises. However that promise must resolve() to an actual result. It cannot resolve to another
Promise.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line202">line 202</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="outputFile"><span class="type-signature"></span>outputFile<span class="type-signature"></span></h4>




<div class="description">
    This method returns a unique filename in the temporary directory. This guarantees it is cleaned up when
the application exits. Rules can use this method to get a unique name to use when they output to a file.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line309">line 309</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
            
<h4 class="name" id="outputStream"><span class="type-signature"></span>outputStream<span class="type-signature"></span></h4>




<div class="description">
    This method returns a writable stream that rules that use streams can use to write into.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line319">line 319</a>
    </li></ul></dd>
    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="asError"><span class="type-signature"></span>asError<span class="signature">(message)</span><span class="type-signature"> &rarr; {Error}</span></h4>

    



<div class="description">
    When a <code>run()</code> method cannot return a valid result is calls this method with a descriptive error message.
Generally it would be used as
<pre><code>return asError(...);</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last">the error message to return.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line174">line 174</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    an Error object encapsulating the error message.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Error</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="asFile"><span class="type-signature"></span>asFile<span class="signature">(filename)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <code>run()</code> methods call this when they are returning a filename. Generally it would be used as
<pre><code>return asFile(...);</code></pre>.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filename</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last">the name of the file to return.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line143">line 143</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    an object used by the validator to encapsulate the file return.
</div>



    



        
            

    

    <h4 class="name" id="asObject"><span class="type-signature"></span>asObject<span class="signature">(data)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <code>run()</code> methods call this when they are returning a data object. Generally it would be used as
<code>return asObject(...);</code>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>data</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last">the data object to return.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line153">line 153</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    an object used by the validator to encapsulate the object return.
</div>



    



        
            

    

    <h4 class="name" id="asStream"><span class="type-signature"></span>asStream<span class="signature">(stream)</span><span class="type-signature"></span></h4>

    



<div class="description">
    <code>run()</code> methods call this when they are returning a readable stream. Generally it would be used as
<pre><code>return asStream(...);</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>stream</code></td>
            

            <td class="type">
            
            </td>

            

            

            <td class="description last">the readable stream to return.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line163">line 163</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    an object used by the validator to encapsulate the stream return.
</div>



    



        
            

    

    <h4 class="name" id="hasFilename"><span class="type-signature"></span>hasFilename<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    Checks whether the rule was initiated with a filename. <code>run()</code> methods would call this so they can
choose to use the filename as opposed to converting the filename into another form such as a stream or data.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line112">line 112</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <code>true</code> if the rule was initialized with a filename and <code>false</code>
otherwise.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="hasObject"><span class="type-signature"></span>hasObject<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    Checks whether the rule was initiated with a data object (unspecified but likely a string). <code>run()</code>
methods would call this so they can
choose to use the object as opposed to converting it into another form such as a file or stream.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line133">line 133</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <code>true</code> if the rule was initialized with a data object and <code>false</code>
otherwise.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="hasStream"><span class="type-signature"></span>hasStream<span class="signature">()</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    



<div class="description">
    Checks whether the rule was initiated with a readable stream. <code>run()</code> methods would call this so they can
choose to use the stream as opposed to converting it into another form such as a file or data.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="RuleAPI.js.html">RuleAPI.js</a>, <a href="RuleAPI.js.html#line122">line 122</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        
<div class="param-desc">
    <code>true</code> if the rule was initialized with a stream and <code>false</code>
otherwise.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BaseRuleAPI.html">BaseRuleAPI</a></li><li><a href="CSVRuleAPI.html">CSVRuleAPI</a></li><li><a href="MetadataRuleAPI.html">MetadataRuleAPI</a></li><li><a href="RuleAPI.html">RuleAPI</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Jul 18 2017 16:16:23 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>