{{outlet}}
<div>
	{{#link-to 'index' tagName='button' class='btn btn-success btn-sm btn-return-title'}}
		{{#bs-tooltip placement="left"}}Return to main page{{/bs-tooltip}}
        <i class="fa fa-angle-double-left"></i>
	{{/link-to}}
</div>
<div>
  {{#if run}}
	<h2>Process A File</h2>
  {{else}}
	<h2>Edit Processing File</h2>
  {{/if}}

  <table id="rulesetTable" class="ruleset-table">
	  <tr style="border-bottom: 1px solid grey;">
		  <td>{{input placeholder="Name" value=rulesetNameFilter}}</td>
          <td>{{input placeholder="Owner" value=rulesetGroupFilter}}</td>
          <td align="center">
          	{{#if run}}
          		Latest Run Results
          	{{/if}}
          </td>
		  <td/>
	  </tr>
    {{#each rulesets as |rulesetInstance index|}}
      <tr id="{{concat 'rulesetTableRow' index}}" class="rule-selectable">
        <td>{{rulesetInstance.filename}}</td>
        <td>{{rulesetInstance.ownergroup}}</td>
        <td align="center">

       		{{#if rulesetInstance.run}}

				{{#if rulesetInstance.run.processing}}
					<i class="fa fa-spinner fa-spin fa-lg fa-fw"></i>
				{{else}}

					{{#link-to "run" rulesetInstance.run.runID}}
						{{#if rulesetInstance.run.details.passed}}
                            <i class="fa fa-thumbs-up good-icon"></i>
						{{else}}
                            <i class="fa fa-thumbs-down error-icon"></i>
						{{/if}}

						{{#if rulesetInstance.run.mixed }}
							<i class="fa fa-exclamation-triangle warning-and-error-icon"></i>
						{{else if rulesetInstance.run.error }}
							<i class="fa fa-exclamation-triangle error-icon"></i>
						{{else if rulesetInstance.run.dropped }}
                            <i class="fa fa-ban warning-icon"></i>
						{{else if rulesetInstance.run.warning }}
							<i class="fa fa-exclamation-triangle warning-icon"></i>
						{{else if rulesetInstance.run.good }}
							<i class="fa fa-check good-icon"></i>
						{{/if}}
						Details
					{{/link-to}}


				{{/if}}
			{{/if}}
        </td>
        <td align="right">
        		{{#if run}}
				{{#bs-button onClick=(action "runRuleset" rulesetInstance.ruleset) disabled=(if-in rulesetInstance.filename processing) }}
					<i class="fa fa-play"></i>
					{{#bs-tooltip placement="top"}}Run ruleset{{/bs-tooltip}}
				{{/bs-button}}
			{{else}}
				{{#bs-button onClick=(action "deleteRuleset" rulesetInstance.ruleset model.rulesets.result)}}
					<i class="fa fa-trash"></i>
					{{#bs-tooltip placement="top"}}Delete ruleset{{/bs-tooltip}}
				{{/bs-button}}

				{{#bs-button onClick=(action "setShowAddRuleset" rulesetInstance.ruleset)}}
					<i class="fa fa-clone"></i>
					{{#bs-tooltip placement="top"}}Clone ruleset{{/bs-tooltip}}
				{{/bs-button}}
				{{#link-to 'editRuleset' rulesetInstance.filename (query-params run=false collapsed=false) tagName='button' class='btn btn-default'}}
					{{#bs-tooltip placement="left"}}Edit ruleset{{/bs-tooltip}}
					<i class="fa fa-pencil"></i>
				{{/link-to}}
			{{/if}}
        </td>
      </tr>
    {{/each}}
	  {{show-paginator pages=model.rulesets.meta.totalPages current=rulePage target='rulePage' inc=(action 'incRulePage') dec=(action 'decRulePage')}}
  </table>

	{{#bs-button onClick=(action "setShowAddRuleset")}}
		Add new file to process
	{{/bs-button}}

</div>

{{#add-ruleset showdialog=showAddRuleset parsers=model.parsers ruleset=cloneRuleset}}{{/add-ruleset}}